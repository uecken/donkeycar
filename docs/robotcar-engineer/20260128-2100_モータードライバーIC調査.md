# モータードライバーIC調査 - SERVO_HBRIDGE_3PIN対応

**作成日**: 2026年1月28日
**最終更新**: 2026年1月28日
**調査目的**: HBX 2192（picopico_racers）向けモータードライバーICの選定

---

## 1. SERVO_HBRIDGE_3PINの制御方式

### 1.1 Donkey Carにおける3ピンモードの仕様

Donkey Carの`actuator.py`に実装されている`L298N_HBridge_3pin`クラスの制御方式：

```python
# donkeycar/parts/actuator.py (756-828行目)
class L298N_HBridge_3pin(object):
    """
    Motor controlled with an L298N hbridge,
    Uses two OutputPins to select direction and
    a PwmPin to control the power to the motor.
    """
```

| ピン | 機能 | 信号タイプ |
|------|------|-----------|
| **FWD_PIN** | 正転方向選択 | TTL出力（GPIO HIGH/LOW） |
| **BWD_PIN** | 逆転方向選択 | TTL出力（GPIO HIGH/LOW） |
| **DUTY_PIN** | 速度制御 | PWM出力（デューティサイクル 0-1） |

### 1.2 制御ロジック

```
前進時: FWD=HIGH, BWD=LOW, DUTY=速度に応じたPWM
後進時: FWD=LOW, BWD=HIGH, DUTY=速度に応じたPWM
停止時: FWD=LOW, BWD=LOW, DUTY=0
ブレーキ: FWD=HIGH, BWD=HIGH（短絡ブレーキ）
```

### 1.3 対応モータードライバーの条件

SERVO_HBRIDGE_3PINモードに対応するには：

1. **IN1/IN2（方向制御）+ PWM（速度制御）の3ピンモード**をサポート
2. **3.3Vロジック対応**（Raspberry Pi GPIO直接接続）
3. **モーター電圧 8.4V以上**に対応（**2S LiPo満充電時は8.4V**）
4. **電流 1A以上**（370モーター対応）

> **重要: 2S LiPoバッテリーの電圧について**
> - 公称電圧: 7.4V（2セル x 3.7V）
> - 満充電電圧: **8.4V**（2セル x 4.2V）
> - 放電終止電圧: 6.0V（2セル x 3.0V）
>
> モータードライバーを選定する際は、**満充電時の8.4V**に対応できることを確認してください。

---

## 2. 秋月電子で購入可能なモータードライバーIC

### 2.1 主要製品一覧

| IC名 | 価格（税込） | 電圧範囲 | 最大電流 | ロジック電圧 | 3ピンモード | 安全機能 | 2S LiPo対応 |
|------|------------|----------|----------|-------------|------------|----------|------------|
| **TB6612FNG** | 180円 | 2.5-13.5V | 1.2A/ch | 2.7-5.5V | ○ | なし | **○** |
| **TB6612 ブレークアウト** | 380円 | 2.5-13.5V | 1.2A/ch | 2.7-5.5V | ○ | なし | **○** |
| **DRV8835 モジュール** | 550円 | 2-11V | 1.5A/ch | 2-7V | ◎（PHASE/ENABLE） | なし | **○** |
| **TC78H660FNG** | 110円 | 2.5-16V | 2A/ch | 2.5-16V | ○（PHASE/IN選択可） | TSD, OCP | **○** |
| **BD6231F-E2** | 200円 | 6-32V | 1A | 3.0V以上 | ○（FIN/RIN+PWM） | OCP, OVP, TSD, UVLO | **○** |
| **TB67H450 モジュール** | 320円 | 4.5-44V | 3A | 3.3V/5V | △（IN/IN方式） | OCP, TSD | **○** |

> **2S LiPo対応について**: 2S LiPoバッテリーは満充電時に**8.4V**に達するため、最大電圧が8.4V以上のICを選択する必要があります。上記のICはすべて対応しています。
>
> **注意**: TC78H653FTG（最大7.5V）は2S LiPoには**非対応**です。似た型番ですが、TC78H660FNG（最大16V）とは異なる製品です。

### 2.2 各ICの詳細分析

---

#### TB6612FNG（東芝）

**秋月電子**: [TB6612FNG](https://akizukidenshi.com/catalog/g/gI-11317/) - 180円

| 項目 | 仕様 |
|------|------|
| モーター電圧 | 2.5V - 13.5V |
| ロジック電圧 | 2.7V - 5.5V |
| 出力電流 | 1.2A（連続）/ 3.2A（ピーク） |
| オン抵抗 | 0.5Ω |
| チャンネル数 | 2ch（デュアルHブリッジ） |
| パッケージ | SSOP24 |

**制御モード**:
```
| IN1 | IN2 | PWM | STBY | 動作 |
|-----|-----|-----|------|------|
| H   | L   | H   | H    | 正転（CW） |
| L   | H   | H   | H    | 逆転（CCW） |
| H   | H   | X   | H    | 短絡ブレーキ |
| L   | L   | H   | H    | 停止（ハイインピーダンス） |
| X   | X   | X   | L    | スタンバイ |
```

**3ピンモード対応**: ○（IN1, IN2で方向、PWMで速度）

**注意点**:
- ロジック電圧は**2.7V以上**が必要
- Raspberry Piの3.3Vロジックで動作可能
- STBYピンをHIGHに固定する必要あり

**参考**: [SparkFun TB6612FNG Hookup Guide](https://learn.sparkfun.com/tutorials/tb6612fng-hookup-guide/all)

---

#### DRV8835（Texas Instruments）

**秋月電子**: [DRV8835使用モジュール](https://akizukidenshi.com/catalog/g/g109848/) - 550円

| 項目 | 仕様 |
|------|------|
| モーター電圧 | 2V - 11V |
| ロジック電圧 | 2V - 7V（**1.8V動作も可能**） |
| 出力電流 | 1.5A（連続）/ 1.5A（ピーク） |
| オン抵抗 | 305mΩ（HS+LS合計） |
| チャンネル数 | 2ch（デュアルHブリッジ） |
| パッケージ | DIP12（モジュール） |

**制御モード**:

**PHASE/ENABLEモード**（MODEピン = HIGH）:
```
| PHASE | ENABLE | 動作 |
|-------|--------|------|
| L     | PWM    | 逆転（速度はPWMデューティ） |
| H     | PWM    | 正転（速度はPWMデューティ） |
| X     | L      | 停止（コースト） |
```

**IN/INモード**（MODEピン = LOW/NC）:
```
| IN1 | IN2 | 動作 |
|-----|-----|------|
| PWM | L   | 正転 |
| L   | PWM | 逆転 |
| L   | L   | コースト |
| H   | H   | ブレーキ |
```

**3ピンモード対応**: ◎（PHASE/ENABLEモードが最適）

**利点**:
- **PHASE/ENABLEモードがSERVO_HBRIDGE_3PINに完全対応**
- 1.8V〜7Vの広いロジック電圧範囲
- 3.3Vロジックで問題なく動作

**参考**: [Pololu DRV8835](https://www.pololu.com/product/2135), [TI DRV8835 Datasheet](https://www.ti.com/lit/gpn/DRV8835)

---

#### TC78H660FNG（東芝）

**秋月電子**: [TC78H660FNG](https://akizukidenshi.com/catalog/g/g117311/) - 110円

| 項目 | 仕様 |
|------|------|
| モーター電圧 | 2.5V - 16V（絶対最大18V） |
| ロジック電圧 | 2.5V - 16V |
| 出力電流 | 2A（最大） |
| オン抵抗 | 0.48Ω |
| チャンネル数 | 2ch（デュアルHブリッジ） |
| パッケージ | SSOP16 |
| **2S LiPo対応** | **○**（満充電8.4Vに対して余裕あり） |

> **注意: TC78H653FTGとの違い**
> - **TC78H660FNG**: 最大16V → 2S LiPo**対応**
> - **TC78H653FTG**: 最大7.5V → 2S LiPo**非対応**（満充電8.4Vを超える）
>
> 型番が似ていますが、電圧仕様が大きく異なります。HBX 2192（7.4V 2S LiPo）には**TC78H660FNG**を使用してください。

**制御モード**（MODEピンで選択）:

**PHASEモード**（MODE = HIGH）:
- PHASE: 方向制御
- ENABLE: 出力ON/OFF（PWM可）

**IN/INモード**（MODE = LOW）:
- IN1, IN2: 個別PWM制御

**3ピンモード対応**: ○（PHASEモード使用時）

**安全機能**:
- 過熱保護（TSD）
- 過電流保護（ISD）
- ERRピンによるエラー通知

**利点**:
- **最安価格**（110円）
- 高電流（2A）
- 保護機能内蔵

**参考**: [Toshiba TC78H660FNG](https://toshiba.semicon-storage.com/us/semiconductor/product/motor-driver-ics/brushed-dc-motor-driver-ics/detail.TC78H660FNG.html)

---

#### BD6231F-E2（ROHM）

**秋月電子**: [BD6231F-E2](https://akizukidenshi.com/catalog/g/g105088/) - 200円

| 項目 | 仕様 |
|------|------|
| モーター電圧 | 6V - 32V |
| ロジック電圧 | 3.0V以上 |
| 出力電流 | 1A（連続） |
| オン抵抗 | 1.5Ω |
| チャンネル数 | 1ch（シングルHブリッジ） |
| パッケージ | SOP8 |

**制御モード**:
- FIN（Forward Input）: 正転制御（PWM入力可）
- RIN（Reverse Input）: 逆転制御（PWM入力可）

**PWM制御モードA/B**:
- VREFピンの設定でPWMモードを選択
- 20kHz〜100kHzのPWM周波数対応

**3ピンモード対応**: ○（FIN, RIN, VREFの組み合わせ）

**安全機能**:
- 過電流保護（OCP）
- 過電圧保護（OVP）
- 過熱保護（TSD）
- 低電圧ロックアウト（UVLO）
- 貫通電流防止回路

**利点**:
- **最も充実した安全機能**
- 高電圧対応（32Vまで）

**欠点**:
- 1チャンネルのみ
- ロジック電圧3.0V以上（3.3Vでギリギリ）
- オン抵抗が高め（1.5Ω）

**参考**: [ROHM BD6231F](https://www.rohm.com/products/motor-actuator-drivers/dc-brush-motor/bd6231f-product)

---

#### TB67H450（東芝）モジュール

**秋月電子**: [TB67H450モジュール](https://akizukidenshi.com/catalog/g/gK-14753/) - 320円

| 項目 | 仕様 |
|------|------|
| モーター電圧 | 4.5V - 44V |
| ロジック電圧 | 3.3V / 5V |
| 出力電流 | 3A（最大） |
| オン抵抗 | 0.6Ω |
| チャンネル数 | 1ch（シングルHブリッジ） |
| パッケージ | SIP8（モジュール） |

**制御モード**:
- IN1, IN2: 両方にPWM入力可能
- 方向選択 + PWM速度制御が可能

**3ピンモード対応**: △（IN/IN方式だが工夫が必要）

**安全機能**:
- 過電流保護（OCP）
- 過熱保護（TSD）

**利点**:
- 高電流（3A）
- 広い電圧範囲
- モジュール化済みで使いやすい

**欠点**:
- 1チャンネルのみ
- 純粋な3ピンモードではない

**参考**: [Toshiba TB67H450](https://toshiba.semicon-storage.com/us/semiconductor/product/motor-driver-ics/brushed-dc-motor-driver-ics/detail.TB67H450FNG.html)

---

## 3. 比較まとめ

### 3.1 SERVO_HBRIDGE_3PIN対応度

| IC | 3ピンモード | 方式 | 追加設定 |
|----|------------|------|----------|
| **DRV8835** | ◎ | PHASE/ENABLE | MODEピン=HIGH |
| **TC78H660FNG** | ○ | PHASE/ENABLE | MODEピン=HIGH |
| **TB6612FNG** | ○ | IN1/IN2 + PWM | STBY=HIGH固定 |
| **BD6231F** | ○ | FIN/RIN + VREF | VREF設定要 |
| **TB67H450** | △ | IN1/IN2 | 工夫が必要 |

### 3.2 HBX 2192向け総合評価

| IC | 価格 | 電圧 | 電流 | 3.3V対応 | 安全機能 | 総合 |
|----|------|------|------|----------|----------|------|
| **DRV8835** | 550円 | ○ | ○ | ◎ | × | ★★★★☆ |
| **TC78H660FNG** | 110円 | ◎ | ◎ | ○ | ○ | ★★★★★ |
| **TB6612FNG** | 180円 | ○ | ○ | ○ | × | ★★★★☆ |
| **BD6231F** | 200円 | △* | ○ | △ | ◎ | ★★★☆☆ |
| **TB67H450** | 320円 | ◎ | ◎ | ○ | ○ | ★★★☆☆ |

*BD6231Fは最低6Vのため7.4Vでは余裕が少ない

---

## 4. 推奨IC

### 4.1 第1推奨: TC78H660FNG

**理由**:
1. **最安価格**（110円）
2. **2チャンネル搭載**（将来の拡張性）
3. **PHASE/ENABLEモードがSERVO_HBRIDGE_3PINに最適**
4. **保護機能内蔵**（OCP, TSD）
5. **2A出力**で370モーターに十分な余裕

**配線例**（HBX 2192 1モーター構成）:
```
Raspberry Pi          TC78H660FNG
GPIO (FWD)  --------> PHASE_A
GPIO (BWD)  --------> [使用せず / GND]
GPIO (PWM)  --------> ENABLE_A
3.3V        --------> VCC (ロジック)
7.4V Battery -------> VM (モーター電源)
GND         --------> GND

※MODEピンをHIGHに接続してPHASE/ENABLEモードを選択
```

**注意**: SERVO_HBRIDGE_3PINの標準動作に合わせるには、Donkey Carのコード側で若干の調整が必要になる可能性があります（FWD=PHASE, DUTY=ENABLE）。

---

### 4.2 第2推奨: DRV8835（モジュール）

**理由**:
1. **PHASE/ENABLEモードが完璧にSERVO_HBRIDGE_3PINに対応**
2. **1.8V〜7Vの広いロジック電圧**
3. **モジュール化済み**でブレッドボード対応
4. **秋月電子で入手可能**

**配線例**:
```
Raspberry Pi          DRV8835
GPIO (FWD)  --------> APHASE (方向)
GPIO (DUTY) --------> AENBL (PWM速度)
3.3V        --------> VCC + MODE (PHASEモード選択)
7.4V Battery -------> VIN
GND         --------> GND
```

---

### 4.3 第3推奨: TB6612FNG

**理由**:
1. **低価格**（180円）
2. **Donkey Carドキュメントで言及されている実績**
3. **情報が豊富**（Raspberry Piとの組み合わせ例多数）

**配線例**:
```
Raspberry Pi          TB6612FNG
GPIO (FWD)  --------> AIN1
GPIO (BWD)  --------> AIN2
GPIO (PWM)  --------> PWMA
3.3V        --------> VCC + STBY
7.4V Battery -------> VM
GND         --------> GND
```

**参考**: [Motor Driver for Raspberry Pi Robot using TB6612FNG](https://www.bluetin.io/dc-motors/motor-driver-raspberry-pi-tb6612fng/)

---

## 5. picopico_racers（HBX 2192）への実装提案

### 5.1 構成

- **モーター制御**: TC78H660FNG または DRV8835
- **サーボ制御**: PWM直接接続 または PCA9685

### 5.2 最小構成（TC78H660FNG使用時）

```
HBX 2192
├── 370モーター (リア駆動)
│   └── TC78H660FNG (1ch使用)
│       ├── PHASE_A ← GPIO (方向)
│       ├── ENABLE_A ← GPIO PWM (速度)
│       └── OUT_A → モーター
│
├── サーボ (フロントステアリング)
│   └── GPIO PWM直接 または PCA9685
│
└── 7.4V 2S LiPo
    ├── VM (モーター電源)
    └── 5V BEC → Raspberry Pi
```

### 5.3 Donkey Car設定例

```python
# myconfig.py

# ドライブトレインタイプ
DRIVE_TRAIN_TYPE = "SERVO_HBRIDGE_3PIN"

# モーター制御ピン（3ピンモード）
HBRIDGE_3PIN_FWD = "RPI_GPIO.BOARD.18"   # PHASE_A (方向)
HBRIDGE_3PIN_BWD = "RPI_GPIO.BOARD.16"   # 使用しない場合はGNDに接続
HBRIDGE_3PIN_DUTY = "RPI_GPIO.BOARD.35"  # ENABLE_A (PWM速度)

# ステアリングサーボ
PWM_STEERING_PIN = "RPI_GPIO.BOARD.33"
```

---

## 6. 購入リンク（秋月電子）

| 製品 | 価格 | リンク |
|------|------|--------|
| TC78H660FNG | 110円 | https://akizukidenshi.com/catalog/g/g117311/ |
| DRV8835モジュール | 550円 | https://akizukidenshi.com/catalog/g/g109848/ |
| TB6612FNG (IC単体) | 180円 | https://akizukidenshi.com/catalog/g/gI-11317/ |
| TB6612 ブレークアウト | 380円 | https://akizukidenshi.com/catalog/g/gK-16947/ |
| BD6231F-E2 | 200円 | https://akizukidenshi.com/catalog/g/g105088/ |
| TB67H450モジュール | 320円 | https://akizukidenshi.com/catalog/g/gK-14753/ |

---

## 7. 参考資料

### Donkey Car
- [Donkey Car Actuators Documentation](https://docs.donkeycar.com/parts/actuators/)
- [Donkey Car Pins Documentation](https://docs.donkeycar.com/parts/pins/)

### モータードライバーIC
- [TB6612FNG Hookup Guide - SparkFun](https://learn.sparkfun.com/tutorials/tb6612fng-hookup-guide/all)
- [DRV8835 Dual Motor Driver - Pololu](https://www.pololu.com/product/2135)
- [TC78H660FNG - Toshiba](https://toshiba.semicon-storage.com/us/semiconductor/product/motor-driver-ics/brushed-dc-motor-driver-ics/detail.TC78H660FNG.html)
- [BD6231F - ROHM](https://www.rohm.com/products/motor-actuator-drivers/dc-brush-motor/bd6231f-product)

### Raspberry Pi
- [DC Motor Control with TB6612FNG - C2P Labs](https://c2plabs.com/blog/2021/09/12/controlling-dc-motor-using-raspberry-pi-pico-rp2040-and-tb6612fng/)
- [Motor Driver for Raspberry Pi - bluetin.io](https://www.bluetin.io/dc-motors/motor-driver-raspberry-pi-tb6612fng/)

---

## 7. 手持ちモジュールの利用可否

ユーザーが所有しているXY-MOSモジュールとMX1508モジュールについて、SERVO_HBRIDGE_3PINモードでの使用可否を調査しました。

---

### 7.1 XY-MOS（D4184 MOSFETモジュール）

#### 仕様

| 項目 | 仕様 |
|------|------|
| **チップ** | D4184 N-channel MOSFET × 2（並列） |
| **入力電圧** | DC 5V - 36V |
| **出力電流** | 15A（連続）/ 30A（冷却時） |
| **最大電力** | 400W |
| **PWM周波数** | 0 - 20kHz |
| **トリガ電圧** | DC 3.3V - 20V |
| **オン抵抗** | 8.5mΩ（典型） |
| **サイズ** | 33.8 × 16.9 × 12mm |
| **動作温度** | -40℃ ～ +85℃ |

#### 内部構成

XY-MOSモジュールは以下の構成です：

```
            ┌────────────────────────────────┐
TRG ───────>│ PC817        │   D4184×2      │
(PWM入力)   │ オプトアイソレータ │   N-ch MOSFET   │──── OUT-
            │              │   (並列接続)     │
GND ───────>│              │                │
            └────────────────────────────────┘
                              │
VIN+ ─────────────────────────┴─────────────── OUT+
                              （直結）
```

**重要なポイント**:
- **片方向スイッチング**のみ対応
- **ローサイドスイッチ**（GND側を切断する方式）
- OUT+はVIN+に直結（常時接続）
- OUT-がMOSFETでスイッチング

#### SERVO_HBRIDGE_3PIN対応可否

| 判定 | 結果 |
|------|------|
| **対応可否** | **× 不可** |

**理由**:

1. **単方向スイッチのみ**: XY-MOSは片方向（ON/OFF）のスイッチングモジュールであり、Hブリッジではありません。モーターの正転/逆転切り替えができません。

2. **ローサイドスイッチ**: GND側を切断する方式のため、Hブリッジ動作に必要な「電流の向き反転」が実現できません。

3. **4つ必要**: 仮にHブリッジを構成する場合、4つのXY-MOSモジュール（ハイサイド×2 + ローサイド×2）が必要ですが、XY-MOSはローサイド専用設計のため、ハイサイドスイッチとしては使用できません。

**代替用途**:
- LEDの調光制御
- ヒーター制御
- リレー代替（大電流ON/OFF）
- **ESCへのブレーキ信号**（単方向制御で十分な場合）

**参考**:
- [D4184 MOSFET Control Module - ProtoSupplies](https://protosupplies.com/product/d4184-mosfet-control-module/)
- [XY-MOS Power Mosfet Module - Raspberry Pi Forums](https://forums.raspberrypi.com/viewtopic.php?t=323198)

---

### 7.2 MX1508（デュアルHブリッジモジュール）

#### 仕様

| 項目 | 仕様 |
|------|------|
| **チップ** | MX1508（P-ch + N-ch MOSFET内蔵） |
| **電源電圧** | 2V - 10V（9.6V最大推奨） |
| **ロジック電圧** | 1.8V - 7V（**3.3V対応**） |
| **出力電流** | 1.5A（連続）/ 2.5A（ピーク） |
| **チャンネル数** | 2ch（デュアルHブリッジ） |
| **スタンバイ電流** | 0.1µA未満 |
| **動作温度** | -20℃ ～ +85℃ |
| **サイズ** | 24.7 × 21 × 5mm |
| **パッケージ** | SOP16（モジュール化済み） |

**注意**: TC1508というクローンICを搭載したモジュールもあり、その場合の最大電圧は7.2Vに制限されます。

#### ピン構成

```
         ┌─────────────┐
    VCC ─┤ +     MB1  ├─ モーターB +
    GND ─┤ -     MB2  ├─ モーターB -
   INT1 ─┤ INT1  MA1  ├─ モーターA +
   INT2 ─┤ INT2  MA2  ├─ モーターA -
   INT3 ─┤ INT3       │
   INT4 ─┤ INT4       │
         └─────────────┘
```

#### 制御方式

MX1508は**IN/INモード**（4ピン制御）で動作します：

| IN1 | IN2 | 動作 |
|-----|-----|------|
| PWM | L   | 正転（速度はPWMデューティ） |
| L   | PWM | 逆転（速度はPWMデューティ） |
| L   | L   | コースト（惰走） |
| H   | H   | ブレーキ（短絡制動） |

#### SERVO_HBRIDGE_3PIN対応可否

| 判定 | 結果 |
|------|------|
| **対応可否** | **△ 条件付きで可能** |

**理由**:

1. **標準モードは4ピン制御**: MX1508の本来の制御方式は、IN1とIN2の両方にPWM信号を入力する「IN/INモード」であり、3ピン（FWD + BWD + DUTY）モードには直接対応していません。

2. **回避策1 - ソフトウェア対応**: Donkey Carの`SERVO_HBRIDGE_2PIN`モードを使用し、IN1とIN2に個別のPWMを入力することで制御可能です。

3. **回避策2 - ハードウェア対応**: 外部ロジック（ANDゲート等）を追加することで3ピンモードに変換可能ですが、複雑になります。

4. **3.3Vロジック対応**: Raspberry Piの3.3V GPIOで直接駆動可能（ロジック電圧1.8V-7V）

#### SERVO_HBRIDGE_2PINでの使用（推奨）

MX1508は`SERVO_HBRIDGE_2PIN`モードで使用することを推奨します：

```python
# myconfig.py

# ドライブトレインタイプ
DRIVE_TRAIN_TYPE = "SERVO_HBRIDGE_2PIN"

# モーター制御ピン（2ピンモード）
HBRIDGE_2PIN_IN1 = "RPI_GPIO.BOARD.33"   # PWM対応ピン → MX1508 IN1
HBRIDGE_2PIN_IN2 = "RPI_GPIO.BOARD.35"   # PWM対応ピン → MX1508 IN2

# ステアリングサーボ
PWM_STEERING_PIN = "RPI_GPIO.BOARD.32"
```

**配線例**:
```
Raspberry Pi              MX1508
GPIO 33 (PWM) ─────────> INT1 (モーターA)
GPIO 35 (PWM) ─────────> INT2 (モーターA)
3.3V ─────────────────> + (VCC)  ※低速テスト用のみ
7.4V Battery ─────────> + (VCC)  ※通常使用
GND ──────────────────> - (GND)

MX1508 MA1 ────────────> モーター +
MX1508 MA2 ────────────> モーター -
```

**注意事項**:
- **電圧上限**: MX1508の最大電圧は9.6V（TC1508は7.2V）のため、7.4V 2S LiPoバッテリーは**使用可能**ですが、満充電時（8.4V）は上限に近いため注意が必要
- **電流上限**: 1.5A連続のため、370モーター（1A程度）であれば問題なし
- **ロジック電源**: MX1508はモーター電源からロジック電圧を生成するため、別途ロジック電源は不要

**参考**:
- [MX1508 DC Motor Driver - Components101](https://components101.com/modules/mx1508-dc-motor-driver-pinout-features-datasheet)
- [MX1508 DC Motor Driver - WatElectronics](https://www.watelectronics.com/mx1508-dc-motor-driver/)
- [RpiMotorLib MX1508 Documentation](https://github.com/gavinlyonsrepo/RpiMotorLib/blob/master/extra/Documentation/MX1508_DC.md)

---

### 7.3 使用可否判定まとめ

| モジュール | SERVO_HBRIDGE_3PIN | SERVO_HBRIDGE_2PIN | 理由 |
|-----------|-------------------|-------------------|------|
| **XY-MOS** | **×** | **×** | 単方向スイッチのためHブリッジ動作不可 |
| **MX1508** | **△**（要工夫） | **○** | 4ピンIN/INモードのため2PINモードで使用推奨 |

---

### 7.4 MX1508を使用する場合の設定詳細

#### Donkey Car設定（SERVO_HBRIDGE_2PIN）

```python
# myconfig.py

# ===========================
# ドライブトレイン設定
# ===========================
DRIVE_TRAIN_TYPE = "SERVO_HBRIDGE_2PIN"

# Hブリッジ 2ピンモード設定（MX1508用）
HBRIDGE_2PIN_IN1 = "RPI_GPIO.BOARD.33"   # PWM対応GPIO → MX1508 INT1
HBRIDGE_2PIN_IN2 = "RPI_GPIO.BOARD.35"   # PWM対応GPIO → MX1508 INT2
HBRIDGE_2PIN_FREQUENCY = 20000            # PWM周波数 (Hz)

# ===========================
# ステアリング設定
# ===========================
STEERING_CHANNEL = 0                       # PCA9685チャンネル（使用時）
# または直接GPIO PWM
# PWM_STEERING_PIN = "RPI_GPIO.BOARD.32"
STEERING_LEFT_PWM = 420
STEERING_RIGHT_PWM = 290
```

#### 配線図（MX1508 + Raspberry Pi）

```
                    ┌────────────────┐
                    │   Raspberry Pi │
                    │                │
7.4V Battery ──┬────┤ 5V (via BEC)   │
               │    │                │
               │    │ GPIO 33 ───────┼──────> MX1508 INT1
               │    │ GPIO 35 ───────┼──────> MX1508 INT2
               │    │ GND ───────────┼──┬───> MX1508 -
               │    └────────────────┘  │
               │                        │
               │    ┌───────────────────┘
               │    │
               ▼    ▼
          ┌─────────────┐
          │   MX1508    │
          │ +       MA1 ├──────> 370モーター +
          │ -       MA2 ├──────> 370モーター -
          │ INT1        │
          │ INT2        │
          └─────────────┘
```

---

### 7.5 推奨事項

1. **新規購入を推奨**: SERVO_HBRIDGE_3PINモードを完全にサポートするには、以下のICを新規購入することを推奨します：
   - **第1推奨**: TC78H660FNG（110円） - PHASE/ENABLEモード対応
   - **第2推奨**: DRV8835モジュール（550円） - PHASE/ENABLEモード対応

2. **MX1508を使用する場合**: SERVO_HBRIDGE_2PINモードで使用可能。ただし電圧上限（9.6V）に注意が必要。

3. **XY-MOSの活用**: モーター制御には不向きですが、以下の用途に活用可能：
   - 大電流LEDの調光
   - ヒーター・ファンの制御
   - リレー代替（ON/OFF制御）

---

## 関連資料

このレポートと関連する他の調査資料：

| 資料名 | 内容 | リンク |
|--------|------|--------|
| GPIO直接制御調査 | GPIO制御の全体像、ハードウェアPWM制限 | [20260128-2000_GPIO直接制御調査.md](./20260128-2000_GPIO直接制御調査.md) |
| HBX2192制御調査 | HBX 2192固有の情報と推奨構成 | [20260128-2010_HBX2192制御調査.md](./20260128-2010_HBX2192制御調査.md) |
| DRV8835配線ガイド | DRV8835を使った具体的な実装手順 | [20260128-2130_DRV8835配線ガイド.md](./20260128-2130_DRV8835配線ガイド.md) |

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2026年1月28日 | 初版作成 - SERVO_HBRIDGE_3PIN対応モータードライバーIC調査 |
| 2026年1月28日 | 手持ちモジュール（XY-MOS、MX1508）の利用可否調査を追記 |
| 2026年1月28日 | 関連資料セクション追加 |
| 2026年1月28日 | **重要な修正**: 2S LiPoバッテリー電圧（満充電8.4V）に関する注意事項を追記。TC78H653FTG（最大7.5V）は2S LiPo非対応であることを明記。TC78H660FNG（最大16V）との違いを強調 |
